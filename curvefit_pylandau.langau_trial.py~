#!/usr/bin/env python
import sys, ScopeTrace, pylandau, os, glob
import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mlp
from scipy.optimize import curve_fit
#-------------------------------------------------------------------------------
# initial settings
mlp.rcParams['axes.linewidth'] = 2
path = os.path.abspath("15192.csv")
print(path)
#path = /home/kpark1/Work/SLab/data
for file in os.listdir("/home/kpark1/Work/SLab/"):
    if file.endswith(".csv"):
        print(os.path.join("/home/kpark1/Work/SLab", file))

list1 = glob.glob('/home/kpark1/Work/SLab/data*.CSV')
if list1 == []:
    print('no file found')
for filename in list1:
    print(filename)
    with open(filename, "r") as file: 
        data= file.read()

#for filepath in glob.glob(os.path.join('data/', '*.csv')):
    #with open(filepath) as f:
        #data = f.read()
## decode the scope trace
        trace = ScopeTrace.ScopeTrace(data,1)

# find baseline and jitter 
#when baseline is the mean y values when x <= 250 and jitter is a mean of sum( (y-baseline)**2
        baseline,jitter = trace.find_baseline_and_jitter(0,250)
        print(baseline)
        inverted_yvalues = []
        for value in trace.yvalues:
            inverted_yvalue = -(value-baseline)
            inverted_yvalues.append(inverted_yvalue)
            print(inverted_yvalues)
#print ' Baseline: %10.6f,  Jitter: %10.6f'%(baseline,jitter)

